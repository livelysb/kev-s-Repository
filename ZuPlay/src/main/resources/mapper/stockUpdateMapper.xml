<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kosta.zuplay.model.dao.StockUpdate">
	<select id="getIsuSrtCd" resultType="String">
		select isusrtcd from lists
	</select>
	<select id="getPrice" resultType="priceDTO">
		select * from price
	</select>
	<insert id="insertDailyPrice" parameterType="priceDTO">
		insert into daily_price(dp_sq, isuCd, dp_clsprc, dp_date) values(rp_sq.nextval, #{isuCd}, #{trdPrc}, sysdate)
	</insert>
	<insert id="insertTrdPrc" parameterType="priceDTO">
		insert into realtime_price(RP_SQ, isuCd, RP_trdPrc, RP_trdTm) values(rp_sq.nextval, #{isuCd}, #{trdPrc}, #{trdTm})
	</insert>
	<update id="priceMerge" parameterType="priceDTO">
		merge into price
		using dual
		on (isuCd=#{isuCd})
		when matched then
		update set
		infoTpCd = #{infoTpCd},
		mktTpCd = #{mktTpCd},
		cmpprevddTpCd = #{cmpprevddTpCd} ,
		cmpprevddPrc =
		#{cmpprevddPrc} ,
		trdPrc = #{trdPrc} ,
		trdvol = #{trdvol} ,
		opnprc =
		#{opnprc} ,
		hgprc = #{hgprc} ,
		lwprc = #{lwprc} ,
		accTrdvol =
		#{accTrdvol} ,
		accTrdval = #{accTrdval} ,
		lstAskbidTpCd =
		#{lstAskbidTpCd} ,
		trdTm = #{trdTm} ,
		askordPrc_1 = #{askordPrc_1} ,
		bidordPrc_1 = #{bidordPrc_1} ,
		mkStatTpCd = #{mkStatTpCd}
		when not
		matched then
		insert into price
		(infoTpCd,mktTpCd,isuCd,cmpprevddTpCd,cmpprevddPrc,trdPrc,trdvol,opnprc,hgprc,lwprc,accTrdvol,accTrdval,lstAskbidTpCd,
		trdTm,askordPrc_1,bidordPrc_1,mkStatTpCd)
		values
		(#{infoTpCd},#{mktTpCd},#{isuCd},#{cmpprevddTpCd},#{cmpprevddPrc},#{trdPrc},#{trdvol},#{opnprc},#{hgprc},#{lwprc},#{accTrdvol},
		#{accTrdval},#{lstAskbidTpCd},#{trdTm},#{askordPrc_1},#{bidordPrc_1},#{mkStatTpCd})
	</update>
</mapper>